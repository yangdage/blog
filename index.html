<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Marks &amp; Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Marks &amp; Notes">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Marks &amp; Notes">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Marks &amp; Notes">
  
    <link rel="alternate" href="/atom.xml" title="Marks &amp; Notes" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
  

  
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f1ea269d2e25e1cda2420b588322207";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">Marks &amp; Notes</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/blog/" id="subtitle">The more I know, the less.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-mark/rest-api-design" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/mark/mark/rest-api-design.html" class="article-date">
  <time datetime="2018-05-15T16:00:00.000Z" itemprop="datePublished">2018-05-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/mark/">mark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/mark/mark/rest-api-design.html">REST API设计最佳实践</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Facebook, Google, Github, Netflix等科技巨头都为开发者和产品提供了API来产生和消费的数据。<br>即使我们写的API不用给其他开发者或者产品使用，我们也应该为我们所开发的代码编写一份精美的API文档。</p>
<p>关于API设计的最佳方式，网络上一直都存在很多争议，始终没有形成一个统一的标准。</p>
<p>API就是访问数据的接口，通过它用户可以生产和消费数据。一个好的API应该是简单易懂，开发者使用时不会产生疑惑。反之，如果一个产品有一个冗长而且看了几遍都还无法理解的API，开发者一般会选着放弃或者寻找其他更简单的替代品。<strong>开发者的使用体验是衡量一个API质量的重要指标。</strong></p>
<p><strong>API就像一个在舞台上表演的演员，用户就是观众</strong></p>
<h3 id="术语"><a href="#术语" class="headerlink" title="术语"></a>术语</h3><p>以下是几个跟REST API相关的重要术语。</p>
<ul>
<li><p>Resource<br><code>Resource</code>表示一组可以被操作的相互关联的数据组成的抽象对象。例如：动物、学校、公司职员可以看做是资源，我们可以针对这些资源进行删除、新增、更新等操作。</p>
</li>
<li><p>Collections<br><code>Collections</code>表示一组资源的集合。</p>
</li>
<li><p>URL<br><code>URL</code>（统一资源定位符）表示访问和操作指定资源的路径。</p>
</li>
</ul>
<h3 id="API路由"><a href="#API路由" class="headerlink" title="API路由"></a>API路由</h3><p>便于理解，以下列举了一些有关公司和职员的<strong>传统API</strong>示例。</p>
<p><code>/getAllEmployees</code></p>
<p><code>/addNewEmployee</code></p>
<p><code>/updateEmployee</code></p>
<p><code>/deleteEmployee</code></p>
<p><code>/promoteEmployee</code></p>
<p>实际中，还有大量的类似上面定义用于不同操作的的API路由。所有这些定义中都包含了多余的动作。因此，随着数量的增加，这些API将变得非常繁杂和难用。</p>
<p><strong>错在哪里？</strong></p>
<p>既然URL表示的是资源，资源应该是名词，而不应该含有动词。<code>/addNewEmployee</code>就包含了<code>addNew</code>的动作在里面。</p>
<p><strong>最佳实践</strong></p>
<p><code>资源名称统一使用复数形式</code></p>
<p><code>/companies</code>这个URL就是一个比较好的示例，那么如何在这个资源上表示出增加、修改、删除的操作呢。</p>
<p>HTTP方法GET、POST、DELETE、PUT就可以很好的表示这些动作。</p>
<p><code>GET /companies</code>表示获取所有公司列表</p>
<p><code>GET /companies/34</code>表示获取ID为34的公司信息</p>
<p><code>DELETE /companies/34</code>表示删除公司ID为34的信息</p>
<p><code>POST /companies</code>表示新建一个新的公司信息，并返回所创建的信息</p>
<p>有时候，我们需要操作资源下的资源，比如要访问或操作公司下的职员信息，可以如下定义API。</p>
<p><code>GET /companies/3/employees</code>表示获取ID为3的公司下的所有职员信息</p>
<p><code>GET /companies/3/employees/45</code>表示获取ID为3的公司下ID为45的职员信息</p>
<p>对于有些HTTP方法表示不了的动作，如解雇、升值、加薪，这种情况可以使用PUT方法和在API的最后附加相关的动作来实现。</p>
<p><code>PUT /companies/3/employees/45/promote</code></p>
<h3 id="条件查询、排序、分页"><a href="#条件查询、排序、分页" class="headerlink" title="条件查询、排序、分页"></a>条件查询、排序、分页</h3><p>这些动作都是基于相同资源的查询操作，我们没有必要再重新为每一个动作设计一个新的API，只需要将相关的参数附加到GET方式的API后面即可。</p>
<p><strong>条件查询</strong></p>
<p><code>GET /companies?category=banking&amp;location=india</code></p>
<p><strong>排序</strong></p>
<p><code>GET /companies?sort=rank_asc</code></p>
<p><strong>分页</strong></p>
<p><code>GET /companies?page=23</code></p>
<p><strong>注：GET方式的请求参数不能太长，太长的话服务器一般会返回一个错误<code>414 URI Too long</code>。这种情况下就需要将GET方式改成POST，并且请求参数放到请求体里面。</strong></p>
<h3 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h3><p>随着产品的迭代，我们的API可能会用在很多产品中，有时候会做出颠覆性的更新，所以前期就需要针对这些API加上版本标识。</p>
<p><code>/v1/companies/34/employees</code></p>
<p><code>/v2/companies/34/employees</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/mark/mark/rest-api-design.html" data-id="cjum4nxv0000waooc5hf33kpr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-mark/rest-api-design" data-title="REST API设计最佳实践" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-go/golang问题记录" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/mark/go/golang问题记录.html" class="article-date">
  <time datetime="2018-03-28T16:00:00.000Z" itemprop="datePublished">2018-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/mark/">mark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/mark/go/golang问题记录.html">golang问题记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="map元素值不可寻址"><a href="#map元素值不可寻址" class="headerlink" title="map元素值不可寻址"></a>map元素值不可寻址</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</div><div class="line">	Name <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	mp := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]Data)</div><div class="line">	mp[<span class="string">"test"</span>] = Data&#123;&#125;</div><div class="line">	mp[<span class="string">"test"</span>].Name = <span class="string">"111"</span></div><div class="line">	fmt.Println(mp)</div><div class="line">&#125;</div><div class="line">运行报错</div><div class="line">cannot assign to <span class="keyword">struct</span> field mp[<span class="string">"test"</span>].Name in <span class="keyword">map</span></div></pre></td></tr></table></figure>
<p>修改成下面即可<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</div><div class="line">	Name <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	mp := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]*Data)</div><div class="line">	mp[<span class="string">"test"</span>] = &amp;Data&#123;&#125;</div><div class="line">	mp[<span class="string">"test"</span>].Name = <span class="string">"111"</span></div><div class="line">	fmt.Printf(<span class="string">"%v\n"</span>, mp)</div><div class="line">&#125;</div><div class="line">输出</div><div class="line"><span class="keyword">map</span>[test:<span class="number">0xc0420461b0</span>]</div></pre></td></tr></table></figure></p>
<p>map的indexing操作本来就是不可寻址的，这和golang中map的具体实现机制有关，golang中的map并没有保证它们的value值的地址是不可变的，因为value值的地址很有可能被重新分配。一个修改的办法就是把value值设置成为指针的形式，即使真正需要的那个值的位置发生了变化，也可以根据指针值索引过去。</p>
<h2 id="String-方法中使用fmt占位符-v-v-导致递归死循环"><a href="#String-方法中使用fmt占位符-v-v-导致递归死循环" class="headerlink" title="String()方法中使用fmt占位符(%v/%+v)导致递归死循环"></a>String()方法中使用fmt占位符(%v/%+v)导致递归死循环</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</div><div class="line">	Name <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Data)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span> &#123;</div><div class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">"%v"</span>, d)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	d := Data&#123;Name: <span class="string">"111"</span>&#125;</div><div class="line">	d.String()</div><div class="line">&#125;</div><div class="line"></div><div class="line">运行以上代码会报如下堆栈溢出错误</div><div class="line">runtime: goroutine stack exceeds <span class="number">1000000000</span>-<span class="keyword">byte</span> limit</div><div class="line">fatal error: stack overflow</div></pre></td></tr></table></figure>
<h2 id="简短变量定义方式只能用在函数内部"><a href="#简短变量定义方式只能用在函数内部" class="headerlink" title="简短变量定义方式只能用在函数内部"></a>简短变量定义方式只能用在函数内部</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	a:=<span class="number">111</span></div><div class="line">	fmt.Println(a)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面的会报错<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a:=<span class="number">111</span>	<span class="comment">//syntax error: non-declaration statement outside function body</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	fmt.Println(a)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="map使用前需要初始化，slice可以不用"><a href="#map使用前需要初始化，slice可以不用" class="headerlink" title="map使用前需要初始化，slice可以不用"></a>map使用前需要初始化，slice可以不用</h2><p>map示例<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> mp <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</div><div class="line">	mp[<span class="string">"name"</span>] = <span class="string">"111"</span>	<span class="comment">//panic: assignment to entry in nil map</span></div><div class="line">	fmt.Println(mp)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>slice示例<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> s []<span class="keyword">int</span></div><div class="line">	s = <span class="built_in">append</span>(s, <span class="number">1</span>)</div><div class="line">	fmt.Println(s)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="map非线程安全"><a href="#map非线程安全" class="headerlink" title="map非线程安全"></a>map非线程安全</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	mp := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</div><div class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line">			mp[<span class="string">"name"</span>] = i</div><div class="line">		&#125;()</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</div><div class="line">		<span class="keyword">go</span> fmt.Println(mp[<span class="string">"name"</span>])</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	&lt;-time.After(<span class="number">2</span> * time.Second)</div><div class="line">&#125;</div><div class="line"></div><div class="line">输出：</div><div class="line">fatal error: concurrent <span class="keyword">map</span> writes</div></pre></td></tr></table></figure>
<p>这里分别启动了100个读，100个写线程操作同一个map对象，偶尔会出现并发错误。再分别增加读写线程数量到1000，并发错误就是必现的。</p>
<h2 id="switch-case分支默认会有break，使用fallthrough可以忽略"><a href="#switch-case分支默认会有break，使用fallthrough可以忽略" class="headerlink" title="switch-case分支默认会有break，使用fallthrough可以忽略"></a>switch-case分支默认会有break，使用fallthrough可以忽略</h2><p>默认<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	a := <span class="number">1</span></div><div class="line">	<span class="keyword">switch</span> a &#123;</div><div class="line">	<span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">		fmt.Println(<span class="number">1</span>)</div><div class="line">	<span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">		fmt.Println(<span class="number">2</span>)</div><div class="line">	<span class="keyword">default</span>:</div><div class="line">		fmt.Println(<span class="string">"unknow"</span>)</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">输出</div><div class="line"><span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>使用fallthrough<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	a := <span class="number">1</span></div><div class="line">	<span class="keyword">switch</span> a &#123;</div><div class="line">	<span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">		fmt.Println(<span class="number">1</span>)</div><div class="line">		<span class="keyword">fallthrough</span></div><div class="line">	<span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">		fmt.Println(<span class="number">2</span>)</div><div class="line">	<span class="keyword">default</span>:</div><div class="line">		fmt.Println(<span class="string">"unknow"</span>)</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">输出 </div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure></p>
<h2 id="struct首字母小写变量不会被序列化-amp-反序列化"><a href="#struct首字母小写变量不会被序列化-amp-反序列化" class="headerlink" title="struct首字母小写变量不会被序列化&amp;反序列化"></a>struct首字母小写变量不会被序列化&amp;反序列化</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Data <span class="keyword">struct</span> &#123;</div><div class="line">	name <span class="keyword">string</span></div><div class="line">	Age <span class="keyword">int</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	d := Data&#123;name: <span class="string">"111"</span>,Age:<span class="number">18</span>&#125;</div><div class="line">	b, _ := json.Marshal(d)</div><div class="line">	fmt.Println(<span class="keyword">string</span>(b))</div><div class="line">&#125;</div><div class="line">输出</div><div class="line">&#123;<span class="string">"Age"</span>:<span class="number">18</span>&#125;</div></pre></td></tr></table></figure>
<h2 id="被defer的函数的参数会在defer声明时求值"><a href="#被defer的函数的参数会在defer声明时求值" class="headerlink" title="被defer的函数的参数会在defer声明时求值"></a>被defer的函数的参数会在defer声明时求值</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	a := <span class="number">1</span></div><div class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"defer a:"</span>, a)</div><div class="line">	a = <span class="number">2</span></div><div class="line">	fmt.Println(<span class="string">"main a:"</span>, a)</div><div class="line">&#125;</div><div class="line">输出</div><div class="line">main a: <span class="number">2</span></div><div class="line"><span class="keyword">defer</span> a: <span class="number">1</span></div></pre></td></tr></table></figure>
<h2 id="函数传参map、slice、channel、指针类型为引用传递-数组为值复制"><a href="#函数传参map、slice、channel、指针类型为引用传递-数组为值复制" class="headerlink" title="函数传参map、slice、channel、指针类型为引用传递,数组为值复制"></a>函数传参map、slice、channel、指针类型为引用传递,数组为值复制</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	arr := [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</div><div class="line">	<span class="comment">//函数传参，数组为值复制</span></div><div class="line">	<span class="function"><span class="keyword">func</span><span class="params">(arr [3]<span class="keyword">int</span>)</span></span> &#123;</div><div class="line">		arr[<span class="number">0</span>] = <span class="number">0</span></div><div class="line">		fmt.Println(arr) <span class="comment">//输出：[0 2 3]</span></div><div class="line">	&#125;(arr)</div><div class="line">	fmt.Println(arr) <span class="comment">//输出：[1 2 3]</span></div><div class="line"></div><div class="line">	<span class="comment">//使用数组指针实现引用传参</span></div><div class="line">	<span class="function"><span class="keyword">func</span><span class="params">(arr *[3]<span class="keyword">int</span>)</span></span> &#123;</div><div class="line">		arr[<span class="number">0</span>] = <span class="number">0</span></div><div class="line">		fmt.Println(*arr) <span class="comment">//输出：[0 2 3]</span></div><div class="line">	&#125;(&amp;arr)</div><div class="line">	fmt.Println(arr) <span class="comment">//输出：[0 2 3]</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="map中取不存在的key的值为“0”值"><a href="#map中取不存在的key的值为“0”值" class="headerlink" title="map中取不存在的key的值为“0”值"></a>map中取不存在的key的值为“0”值</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	mp := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</div><div class="line">	mp[<span class="string">"111"</span>] = <span class="number">1</span></div><div class="line">	fmt.Println(mp[<span class="string">"000"</span>]) <span class="comment">//输出：0</span></div><div class="line"></div><div class="line">	<span class="comment">// 判断是否存在，最好使用下面方式判断ok的值</span></div><div class="line">	<span class="keyword">if</span> v, ok := mp[<span class="string">"111"</span>]; ok &#123;</div><div class="line">		fmt.Println(v) <span class="comment">//输出：1</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="nil值的interface-不一定等于nil"><a href="#nil值的interface-不一定等于nil" class="headerlink" title="nil值的interface{}不一定等于nil"></a>nil值的interface{}不一定等于nil</h2><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> data *<span class="keyword">int</span></div><div class="line">	<span class="keyword">var</span> v <span class="keyword">interface</span>&#123;&#125;</div><div class="line"></div><div class="line">	fmt.Println(data, data == <span class="literal">nil</span>) <span class="comment">//&lt;nil&gt; true</span></div><div class="line">	fmt.Println(v, v == <span class="literal">nil</span>)       <span class="comment">//&lt;nil&gt; true</span></div><div class="line"></div><div class="line">	v = data</div><div class="line">	fmt.Println(v, v == <span class="literal">nil</span>) <span class="comment">//&lt;nil&gt; false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在golang中，nil只能赋值给指针、channel、func、interface、map或slice类型的变量。</p>
<p>interface{}表示任意类型，可以接收任意类型的值。interface{}变量在底是由类型和值两部分组成，表示为(T,V)，interface{}变量比较特殊，判断它是nil时，要求它的类型和值都是nil，即(nil, nil)。<br>其它类型变量，只要值是nil，那么此变量就是nil（为什么？变量类型不是nil，那当然只能用值来判断了）</p>
<p>声明变量interface{}，它默认就是nil，底层类型与值表示是(nil, nil)。<br>当任何类型T的变量值V给interface{}变量赋值时，interface{}变量的底层表示是(T, V)。只要T非nil，即使V是nil，interface{}变量也不是nil。</p>
<h2 id="内存泄漏"><a href="#内存泄漏" class="headerlink" title="内存泄漏"></a>内存泄漏</h2><p>go语言自带了内存回收机制，因此一般情况下不会存在内存泄漏问题。但是以下两种常用情况很容易导致内存泄漏。</p>
<p><strong>数组引用切片</strong><br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	dataMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>][]<span class="keyword">byte</span>)</div><div class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</div><div class="line">		fileName := <span class="string">"./main.go"</span></div><div class="line">		data, err := ioutil.ReadFile(fileName)</div><div class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">			<span class="built_in">panic</span>(err)</div><div class="line">		&#125;</div><div class="line">		dataMap[fileName] = data[<span class="number">0</span>:]</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	fmt.Printf(<span class="string">"%v"</span>, dataMap)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>解决方案：克隆一份数据</strong><br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	dataMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>][]<span class="keyword">byte</span>)</div><div class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</div><div class="line">		fileName := <span class="string">"./main.go"</span></div><div class="line">		data, err := ioutil.ReadFile(fileName)</div><div class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">			<span class="built_in">panic</span>(err)</div><div class="line">		&#125;</div><div class="line">		dataMap[fileName] = <span class="built_in">append</span>([]<span class="keyword">byte</span>&#123;&#125;,data[<span class="number">0</span>:]...)</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	fmt.Printf(<span class="string">"%v"</span>, dataMap)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>goroutine不能正常退出</strong><br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	ch := <span class="function"><span class="keyword">func</span><span class="params">()</span> &lt;-<span class="title">chan</span> <span class="title">int</span></span> &#123;</div><div class="line">		ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</div><div class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; ; i++ &#123;</div><div class="line">				ch &lt;- i</div><div class="line">			&#125;</div><div class="line">		&#125;()</div><div class="line">		<span class="keyword">return</span> ch</div><div class="line">	&#125;()</div><div class="line"></div><div class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> ch &#123;</div><div class="line">		fmt.Println(v)</div><div class="line">		<span class="keyword">if</span> v == <span class="number">5</span> &#123;</div><div class="line">			<span class="keyword">break</span></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>解决方案：引入Context或者自定义通知channel</strong><br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	ctx, cancel := context.WithCancel(context.Background())</div><div class="line">	ch := <span class="function"><span class="keyword">func</span><span class="params">()</span> &lt;-<span class="title">chan</span> <span class="title">int</span></span> &#123;</div><div class="line">		ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</div><div class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; ; i++ &#123;</div><div class="line">				<span class="keyword">select</span> &#123;</div><div class="line">				<span class="keyword">case</span> &lt;-ctx.Done():</div><div class="line">					<span class="keyword">return</span></div><div class="line">				<span class="keyword">case</span> ch &lt;- i:</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;()</div><div class="line">		<span class="keyword">return</span> ch</div><div class="line">	&#125;()</div><div class="line"></div><div class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> ch &#123;</div><div class="line">		fmt.Println(v)</div><div class="line">		<span class="keyword">if</span> v == <span class="number">5</span> &#123;</div><div class="line">			cancel()</div><div class="line">			<span class="keyword">break</span></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>或<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</div><div class="line">	ch := <span class="function"><span class="keyword">func</span><span class="params">()</span> &lt;-<span class="title">chan</span> <span class="title">int</span></span> &#123;</div><div class="line">		ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</div><div class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line">			<span class="keyword">for</span> i := <span class="number">0</span>; ; i++ &#123;</div><div class="line">				<span class="keyword">select</span> &#123;</div><div class="line">				<span class="keyword">case</span> &lt;-done:</div><div class="line">					<span class="keyword">return</span></div><div class="line">				<span class="keyword">case</span> ch &lt;- i:</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;()</div><div class="line">		<span class="keyword">return</span> ch</div><div class="line">	&#125;()</div><div class="line"></div><div class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> ch &#123;</div><div class="line">		fmt.Println(v)</div><div class="line">		<span class="keyword">if</span> v == <span class="number">5</span> &#123;</div><div class="line">			done &lt;- <span class="literal">true</span></div><div class="line">			<span class="keyword">break</span></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/mark/go/golang问题记录.html" data-id="cjum4nxup000haoocvc9kggn4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-go/golang问题记录" data-title="golang问题记录" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-mark/use-make-in-windows" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/mark/mark/use-make-in-windows.html" class="article-date">
  <time datetime="2018-02-28T16:00:00.000Z" itemprop="datePublished">2018-03-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/mark/">mark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/mark/mark/use-make-in-windows.html">Windows下使用make命令</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h3><ul>
<li>git安装程序</li>
<li>make工具包</li>
</ul>
<h2 id="下载安装最新的git工具"><a href="#下载安装最新的git工具" class="headerlink" title="下载安装最新的git工具"></a>下载安装最新的git工具</h2><p><a href="https://git-scm.com/downloads" target="_blank" rel="external">git工具下载地址</a><br>下载最新的git可执行安装程序直接安装即可。<br>由于Windows上git bash终端是基于MIMGW，MIMGW是一个简单版的Linux命令行工具，可以执行一些基本的Linux命令。但是没有集成make工具，所以要手动安装。</p>
<h2 id="下载安装make工具包"><a href="#下载安装make工具包" class="headerlink" title="下载安装make工具包"></a>下载安装make工具包</h2><p><a href="">make工具包下载地址</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/mark/mark/use-make-in-windows.html" data-id="cjum4nxv40012aoociwwl2h67" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-mark/use-make-in-windows" data-title="Windows下使用make命令" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-go/golang闭包问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/go/go/golang闭包问题.html" class="article-date">
  <time datetime="2017-05-31T16:00:00.000Z" itemprop="datePublished">2017-06-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/go/">go</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/go/go/golang闭包问题.html">golang闭包问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>关于闭包，网上有这样一句描述</p>
<p><strong>“类是有行为的数据，而闭包是有数据的行为”</strong></p>
<p>说的通俗一点：闭包是有上下文的</p>
<p>下面是一段程序的示例<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    arr := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</div><div class="line">    <span class="keyword">for</span> _, x := <span class="keyword">range</span> arr &#123;</div><div class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line">            fmt.Println(x)</div><div class="line">        &#125;()</div><div class="line">    &#125;</div><div class="line">    &lt;-time.After(<span class="number">1</span> * time.Second)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>运行上面的程序，会有多种输出结果</p>
<blockquote>
<p>4<br>3<br>4<br>4</p>
</blockquote>
<p>或者</p>
<blockquote>
<p>4<br>4<br>4<br>4</p>
</blockquote>
<p>等等…</p>
<p>for循环里每次遍历都会启动一个goroutine执行匿名函数打印变量x的值，x是4个goroutine共享的外部变量。随着main线程for循环的执行，x的值也会随着修改。</p>
<p>由于闭包中使用的非参数传递变量属于引用传递，所以4个goroutine中都是使用的是外部变量x的引用，因此输出x的值自然也就具有了不确定性。</p>
<p>如果想要4个goroutine分别输出1,2,3,4，只需要将x传递方式改成参数传递即可，修改如下<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    arr := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</div><div class="line">    <span class="keyword">for</span> _, x := <span class="keyword">range</span> arr &#123;</div><div class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span></span> &#123;</div><div class="line">            fmt.Println(x)</div><div class="line">        &#125;(x)</div><div class="line">    &#125;</div><div class="line">    &lt;-time.After(<span class="number">1</span> * time.Second)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这样每个goroutine中的x都是值传递，值也不相同，避免了使用闭包时引用外部变量导致的莫名其妙问题。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/go/go/golang闭包问题.html" data-id="cjum4nxu80003aoocksszz7nd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-go/golang闭包问题" data-title="golang闭包问题" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-go/golang时区转换问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/go/go/golang时区转换问题.html" class="article-date">
  <time datetime="2017-03-31T16:00:00.000Z" itemprop="datePublished">2017-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/go/">go</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/go/go/golang时区转换问题.html">golang时区转换问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="time-Parse默认转换时间为UTC时区"><a href="#time-Parse默认转换时间为UTC时区" class="headerlink" title="time.Parse默认转换时间为UTC时区"></a>time.Parse默认转换时间为UTC时区</h3><p>golang中转换时间的时候都是习惯性的直接使用time.Parse()函数，没有注意这个函数转换出来的时间默认会是UTC国际标准时间。</p>
<p>这个时间是伦敦时间时间为准，中国大陆、中国香港、中国澳门、中国台湾、蒙古国、新加坡、马来西亚、菲律宾、西澳大利亚州的时间与UTC的时差均为+8，也就是UTC+8。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">t1, _ := time.Parse(<span class="string">"2006-01-02 15:04:05"</span>, <span class="string">"2017-04-01 13:02:01"</span>)</div><div class="line">t2, _ := time.ParseInLocation(<span class="string">"2006-01-02 15:04:05"</span>, <span class="string">"2017-04-01 13:02:01"</span>, time.Local)</div><div class="line"><span class="comment">//结果:Parse:8</span></div><div class="line">fmt.Printf(<span class="string">"Parse:%v\n"</span>, t1.Sub(t2).Seconds() / <span class="number">3600</span>)</div></pre></td></tr></table></figure>
<p>以上结果Parse函数转换的时间是跟本地时间相差了8个小时。</p>
<p>如果有需求计算两个时间间隔的，最好使用ParseInLocation函数转换成本地时区的时间进行计算。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/go/go/golang时区转换问题.html" data-id="cjum4nxuj0009aooc6k76z4de" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-go/golang时区转换问题" data-title="golang时区转换问题" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-mark/mysql-engines" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/mark/mark/mysql-engines.html" class="article-date">
  <time datetime="2016-05-16T16:00:00.000Z" itemprop="datePublished">2016-05-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/mark/">mark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/mark/mark/mysql-engines.html">MySql存储引擎</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h3><p>存储引擎就是针对如何存储数据、如何针对存储的数据进行增删改查而实现的一堆技术组合。目前主流的数据库还是关系型的数据库，在关系型数据库中数据主要以表的方式呈现的，所以存储引擎也被称作表类型（存储、操作表的类型）。</p>
<p>MySql中提供非常丰富的存储引擎适用于不同的业务场景，其中InnoDB和MyISAM为最常用的两种。MySql5.5.5之后版本默认为InnoDB类型，之前为MyISAM类型。</p>
<h3 id="MyISAM"><a href="#MyISAM" class="headerlink" title="MyISAM"></a>MyISAM</h3><p><strong>优点</strong></p>
<ul>
<li>查询速度快</li>
<li>支持全文索引（FULLTEXT）</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>不支持事务</li>
<li>不支持外键</li>
<li>不支持高并发（表级锁）</li>
</ul>
<p><strong>适用场景</strong></p>
<ul>
<li>查询和插入为主</li>
<li>并发要求低</li>
<li>安全性要求不高</li>
</ul>
<p><strong>存储形式</strong><br>每个表对应三个文件</p>
<ul>
<li><code>.frm</code>表定义文件</li>
<li><code>.MYD</code>数据文件</li>
<li><code>.MYI</code>索引文件</li>
</ul>
<h3 id="InnoDB"><a href="#InnoDB" class="headerlink" title="InnoDB"></a>InnoDB</h3><p><strong>优点</strong></p>
<ul>
<li>支持事务</li>
<li>支持外键</li>
<li>支持高并发（行级锁）</li>
<li>支持自增长列</li>
<li>支持崩溃数据自修复</li>
<li>支持全文索引（5.6版本以后）</li>
<li>支持地理坐标（5.7版本以后）</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>查询速度稍慢</li>
<li>占用更多磁盘空间存储索引和数据</li>
</ul>
<p><strong>适用场景</strong></p>
<ul>
<li>频繁更新修改</li>
<li>并发要求高</li>
<li>安全性要求高</li>
</ul>
<p><strong>存储形式</strong></p>
<ul>
<li>表空间数据文件</li>
<li>日志文件</li>
</ul>
<h3 id="Count示例"><a href="#Count示例" class="headerlink" title="Count示例"></a>Count示例</h3><p><code>select count(*) from table</code><br>MyISAM只要简单的读出保存好的行数，InnoDB中没有保存表的具体行数，所以会进行一次全表扫描。</p>
<p><code>select count(*) from table where ...</code><br>但是查询语句中含有条件语句，两种存储引擎都会进行全表扫描。</p>
<h3 id="行表锁示例"><a href="#行表锁示例" class="headerlink" title="行表锁示例"></a>行表锁示例</h3><p><code>update table set num=1 where name like &#39;%aaa%&#39;</code><br>虽然InnoDB中提供了行级锁,如上update语句当不能确定要扫描的范围时，还是会锁全表。</p>
<h3 id="ACID特性"><a href="#ACID特性" class="headerlink" title="ACID特性"></a>ACID特性</h3><ul>
<li><p><code>A(Atomicity)</code>原子性<br>原子性意思是事务执行是作为原子，即不可再分。相关概念：自动提交设置、<code>commit</code>语句、<code>rollback</code>语句。</p>
</li>
<li><p><code>C(Consistency)</code>一致性<br>一致性主要负责保护数据和从奔溃中恢复数据：双写缓存、奔溃恢复。</p>
</li>
<li><p><code>I(Isolation)</code>隔离性<br>表现多个事务之间的互不干扰。一个事务不可能看到其他事务运行时中间某一时刻的数据。</p>
</li>
<li><p><code>D(Durability)</code>持久性<br>持久性，意味着在事务完成以后，该事务所对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。<br>即使出现了任何事故比如断电等，事务一旦提交，则持久化保存在数据库中。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/mark/mark/mysql-engines.html" data-id="cjum4nxv30010aooc0fs8oed7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-mark/mysql-engines" data-title="MySql存储引擎" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-cache/Redis缓存失效更新策略" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/cache/cache/Redis缓存失效更新策略.html" class="article-date">
  <time datetime="2016-04-23T16:00:00.000Z" itemprop="datePublished">2016-04-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/cache/">cache</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/cache/cache/Redis缓存失效更新策略.html">Redis缓存失效策略</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>当缓存失效时，一般会去DB查询数据，再次加载到缓存，并设置好失效时间。但是在高并发的情况下，缓存失效会导致DB的压力陡增，也叫做缓存穿透。</p>
<p>最理想的状态是，我们缓存中一直有需要查询的数据，查询永远不会直接穿透到DB层。当然，这只是理想状态，一般情况下我们只要防止在缓存失效的时候不让高并发请求打到我们DB的查询上就行。解决方式是在DB查询时保证只有一个任务在执行就行。这里要区分单系统和分布式系统的情况。</p>
<p>这里有几种缓存更新的策略。</p>
<h3 id="定时器查询数据更新到缓存"><a href="#定时器查询数据更新到缓存" class="headerlink" title="定时器查询数据更新到缓存"></a>定时器查询数据更新到缓存</h3><p>系统启动指定的定时器去定时更新缓存中的数据。所有用户的请求都只查询缓存中的数据，缓存中没有也不会去查询DB。这种方式适合能够确定查询的数据一定是热数据、小数据的情况。如果是针对无法区分冷热的数据，也不知道到底要查哪些数据放到缓存中合适，这种情况就不适合用这种方式更新缓存。</p>
<h3 id="查询DB任务加锁"><a href="#查询DB任务加锁" class="headerlink" title="查询DB任务加锁"></a>查询DB任务加锁</h3><p>当缓存中取不到数据时，在查询DB的方法上加锁，保证只有一个线程查询DB。如果确定只有一个web服务的话，这种方式是最方便快速的解决方式，但是我们不能保证我们的系统以后不会部署分布式集群里。如果部署到集群里，我们在任务上加锁也没用，实际上还是有并发的DB查询。</p>
<h3 id="使用缓存锁查询DB任务"><a href="#使用缓存锁查询DB任务" class="headerlink" title="使用缓存锁查询DB任务"></a>使用缓存锁查询DB任务</h3><p>Redis提供了<code>SETNX</code>命令设置一个key，这个命令意思是，如果要设置的key不存在则返回1，如果已存在则返回0，memcached也提供了类似的<code>add</code>命令。无论是单点系统还是分布式系统都能保证同一时间只有一个查询DB的任务。缓存锁最好加上一个很短的失效时间，确保这个时间内任务能够执行完就好，一般定为3-5秒，设置缓存失效时间的另一个重要原因是考虑到任务可能执行失败的情况，后续请求能继续使用这个缓存锁。</p>
<h3 id="双key缓存，一个缓存数据，一个缓存失效时间"><a href="#双key缓存，一个缓存数据，一个缓存失效时间" class="headerlink" title="双key缓存，一个缓存数据，一个缓存失效时间"></a>双key缓存，一个缓存数据，一个缓存失效时间</h3><p>假设要缓存一个用户信息，并且缓存将在30分钟后失效。</p>
<p>设计一个key（userInfo_{userId}）缓存用户信息数据，并且设置失效时间为30分钟。<br>再设计一个key（expire<em>userInfo</em>{userId}）,值随便定，并且设置失效时间为25分钟，一定要在主要信息失效之前失效。<br>查询数据时先查key（expire<em>userInfo</em>{userId}）是否存在，如果不存在，则继续按上一个解决方式使用缓存锁启动一个任务查询用户信息数据追加到缓存里，并且设置失效时间为30分钟，另增对应缓存失效key，设置缓存失效时间为25分钟。如果存在则继续查询用户信息key（userInfo_{userId}）对应的数据返回。</p>
<h3 id="双key缓存，一个用作缓存锁，一个缓存数据，缓存数据最前面加上系统时间"><a href="#双key缓存，一个用作缓存锁，一个缓存数据，缓存数据最前面加上系统时间" class="headerlink" title="双key缓存，一个用作缓存锁，一个缓存数据，缓存数据最前面加上系统时间"></a>双key缓存，一个用作缓存锁，一个缓存数据，缓存数据最前面加上系统时间</h3><p>缓存锁功能还是跟上面的一样，缓存数据，设置失效时间为30分钟，数据最前面加上系统时间类似（time_value）,当读取缓存数据的时候，如果缓存中没有或者当前时间减time小于5分钟，使用缓存锁查询DB任务，并更新缓存。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/cache/cache/Redis缓存失效更新策略.html" data-id="cjum4nxuo000gaooc1t3p21zg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-cache/Redis缓存失效更新策略" data-title="Redis缓存失效策略" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-mark/docker常用命令" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/mark/mark/docker常用命令.html" class="article-date">
  <time datetime="2016-04-19T16:00:00.000Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/mark/">mark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/mark/mark/docker常用命令.html">Docker常用命令</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="版本查看"><a href="#版本查看" class="headerlink" title="版本查看"></a>版本查看</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker version</div></pre></td></tr></table></figure>
<h3 id="搜索镜像"><a href="#搜索镜像" class="headerlink" title="搜索镜像"></a>搜索镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker search <span class="variable">$imageName</span>$</div></pre></td></tr></table></figure>
<h3 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker pull <span class="variable">$imageName</span>$</div></pre></td></tr></table></figure>
<h3 id="查看所有镜像"><a href="#查看所有镜像" class="headerlink" title="查看所有镜像"></a>查看所有镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker images</div></pre></td></tr></table></figure>
<h3 id="查看镜像历史"><a href="#查看镜像历史" class="headerlink" title="查看镜像历史"></a>查看镜像历史</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker <span class="built_in">history</span> <span class="variable">$imageName</span>$</div></pre></td></tr></table></figure>
<h3 id="删除所有镜像"><a href="#删除所有镜像" class="headerlink" title="删除所有镜像"></a>删除所有镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker rmi $(docker images -q)</div></pre></td></tr></table></figure>
<h3 id="删除所有未打标签的镜像"><a href="#删除所有未打标签的镜像" class="headerlink" title="删除所有未打标签的镜像"></a>删除所有未打标签的镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker rmi $(docker images -q -f dangling=<span class="literal">true</span>)</div></pre></td></tr></table></figure>
<h3 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker push <span class="variable">$imageName</span>$</div></pre></td></tr></table></figure>
<h3 id="查看所有容器"><a href="#查看所有容器" class="headerlink" title="查看所有容器"></a>查看所有容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker ps -a</div></pre></td></tr></table></figure>
<h3 id="查看最近启动的容器"><a href="#查看最近启动的容器" class="headerlink" title="查看最近启动的容器"></a>查看最近启动的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker ps -l</div></pre></td></tr></table></figure>
<h3 id="查看所有容器ID"><a href="#查看所有容器ID" class="headerlink" title="查看所有容器ID"></a>查看所有容器ID</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker ps -a -q</div></pre></td></tr></table></figure>
<h3 id="杀死所有启动的容器"><a href="#杀死所有启动的容器" class="headerlink" title="杀死所有启动的容器"></a>杀死所有启动的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker <span class="built_in">kill</span> $(docker ps -a -q)</div></pre></td></tr></table></figure>
<h3 id="删除所有容器"><a href="#删除所有容器" class="headerlink" title="删除所有容器"></a>删除所有容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker rm $(docker ps -a -q)</div></pre></td></tr></table></figure>
<h3 id="保存容器为镜像"><a href="#保存容器为镜像" class="headerlink" title="保存容器为镜像"></a>保存容器为镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker commit <span class="variable">$containerID</span>$ <span class="variable">$newImageName</span>$</div></pre></td></tr></table></figure>
<h3 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">docker run [OPTIONS] IMAGE[:TAG] [COMMAND] [ARG...]</div><div class="line"></div><div class="line">OPTIONS:</div><div class="line">-i:标准输入给容器</div><div class="line">-t:分配一个虚拟终端</div><div class="line">-d:以守护进程方式运行</div><div class="line">-P:默认匹配docker容器的5000端口号到宿主机的49153 to 65535端口</div><div class="line">-p HOT_PORT:CONTAINER_PORT:指定端口号</div><div class="line">--name:指定容器的名称</div><div class="line">--rm:退出时删除容器</div></pre></td></tr></table></figure>
<h3 id="进入容器终端"><a href="#进入容器终端" class="headerlink" title="进入容器终端"></a>进入容器终端</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -i -t <span class="variable">$imageName</span>$ /bin/bash</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/mark/mark/docker常用命令.html" data-id="cjum4nxv60014aoocef89vdeh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-mark/docker常用命令" data-title="Docker常用命令" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-go/go-gob" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/go/go/go-gob.html" class="article-date">
  <time datetime="2016-04-18T16:00:00.000Z" itemprop="datePublished">2016-04-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/go/">go</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/go/go/go-gob.html">Go中gob序列化反序列化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="gob序列化反序列化"><a href="#gob序列化反序列化" class="headerlink" title="gob序列化反序列化"></a>gob序列化反序列化</h3><p>当使用了gob序列化一个对象，反序列化时一定要同样使用gob反序列化。因为使用gob序列化对象时会在字节数组最前面加上字节头数据。</p>
<h3 id="普通string与-byte转换"><a href="#普通string与-byte转换" class="headerlink" title="普通string与[]byte转换"></a>普通<strong>string</strong>与<strong>[]byte</strong>转换</h3><p>string转换为byte数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> s <span class="keyword">string</span> = <span class="string">"abcdefg"</span></div><div class="line">	bs := []<span class="keyword">byte</span>(s)</div><div class="line">	<span class="comment">//[97 98 99 100 101 102 103]</span></div><div class="line">	fmt.Println(bs)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>byte数组转string</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> bs1 = []<span class="keyword">byte</span>&#123;<span class="number">97</span>, <span class="number">98</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>, <span class="number">103</span>&#125;</div><div class="line">	<span class="keyword">var</span> s <span class="keyword">string</span> = <span class="keyword">string</span>(bs1)</div><div class="line">	<span class="comment">//abcdefg</span></div><div class="line">	fmt.Println(s)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="使用gob转换string和-byte"><a href="#使用gob转换string和-byte" class="headerlink" title="使用gob转换string和[]byte"></a>使用gob转换<strong>string</strong>和<strong>[]byte</strong></h3><p>string转byte数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"bytes"</span></div><div class="line">	<span class="string">"encoding/gob"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> s <span class="keyword">string</span> = <span class="string">"abcdefg"</span></div><div class="line">	buf := &amp;bytes.Buffer&#123;&#125;</div><div class="line">	gob.NewEncoder(buf).Encode(&amp;s)</div><div class="line">	bs := buf.Bytes()</div><div class="line">	<span class="comment">//[10 12 0 7 97 98 99 100 101 102 103]</span></div><div class="line">	fmt.Println(bs)</div><div class="line"></div><div class="line">	<span class="comment">//     abcdefg</span></div><div class="line">	fmt.Println(s1)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>gob将string转byte数组时候会在最前面加上4个字节的头数据，这时如果使用普通方式将这个字节数组转string，前面会多出莫名奇妙的字符（显示为空格）。其中Encode()方法和Decode()方法都需传一个指针参数。Go会根据反射机制自动查找对应的数据结构类型。</p>
<p>byte数组转string</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"bytes"</span></div><div class="line">	<span class="string">"encoding/gob"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	<span class="keyword">var</span> s <span class="keyword">string</span> = <span class="string">"abcdefg"</span></div><div class="line">	buf := &amp;bytes.Buffer&#123;&#125;</div><div class="line">	gob.NewEncoder(buf).Encode(&amp;s)</div><div class="line">	<span class="keyword">var</span> s1 <span class="keyword">string</span></div><div class="line">	gob.NewDecoder(buf).Decode(&amp;s1)</div><div class="line">	<span class="comment">//abcdefg</span></div><div class="line">	fmt.Println(s1)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/go/go/go-gob.html" data-id="cjum4nxui0008aoocw1dbl1fd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-go/go-gob" data-title="Go中gob序列化反序列化" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  
    <article id="post-mark/markdown-mathjax" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/mark/mark/markdown-mathjax.html" class="article-date">
  <time datetime="2016-04-11T16:00:00.000Z" itemprop="datePublished">2016-04-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/mark/">mark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/mark/mark/markdown-mathjax.html">Mathjax in Markdown</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="分数表示"><a href="#分数表示" class="headerlink" title="分数表示"></a>分数表示</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\frac&#123;1&#125;&#123;3&#125; 或者 1 \over 3</div></pre></td></tr></table></figure>
<p>$\frac{1}{3}$</p>
<h3 id="上标下标"><a href="#上标下标" class="headerlink" title="上标下标"></a>上标下标</h3><p>^表示上标，_表示下标</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x^2</div></pre></td></tr></table></figure>
<p>$x^2$</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x_2</div></pre></td></tr></table></figure>
<p>$x_2$</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x^&#123;y^2&#125;=(1+&#123;\rm e&#125;^2)^&#123;-2xy&#125;</div></pre></td></tr></table></figure>
<p>$x^{y^2}=(1+{\rm e}^2)^{-2xy}$</p>
<h3 id="矢量"><a href="#矢量" class="headerlink" title="矢量"></a>矢量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\vec&#123;a&#125; \cdot \vec&#123;b&#125;=0</div></pre></td></tr></table></figure>
<p>$\vec{a} \cdot \vec{b}=0$</p>
<h3 id="微积分"><a href="#微积分" class="headerlink" title="微积分"></a>微积分</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\int_0^1 x^2 &#123;\rm d&#125;x</div></pre></td></tr></table></figure>
<p>$\int_0^1 x^2 {\rm d}x$</p>
<h3 id="极限运算"><a href="#极限运算" class="headerlink" title="极限运算"></a>极限运算</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\lim_&#123;n \rightarrow +\infty&#125; \frac&#123;1&#125;&#123;n(n+1)&#125;</div></pre></td></tr></table></figure>
<p>$\lim_{n \rightarrow +\infty} \frac{1}{n(n+1)}$</p>
<h3 id="累加、累乘"><a href="#累加、累乘" class="headerlink" title="累加、累乘"></a>累加、累乘</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\sum_&#123;i=0&#125;^n \frac&#123;1&#125;&#123;i^2&#125; 和 \prod_&#123;i=0&#125;^n \frac&#123;1&#125;&#123;i^2&#125;</div></pre></td></tr></table></figure>
<p>$\sum_{i=0}^n \frac{1}{i^2}$</p>
<p>$\prod_{i=0}^n \frac{1}{i^2}$</p>
<h3 id="函数表示"><a href="#函数表示" class="headerlink" title="函数表示"></a>函数表示</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\cos 2\theta = \cos^2 \theta - \sin^2 \theta =  2 \cos^2 \theta - 1</div></pre></td></tr></table></figure>
<p>$\cos 2\theta = \cos^2 \theta - \sin^2 \theta =  2 \cos^2 \theta - 1$</p>
<h3 id="标准正态分布"><a href="#标准正态分布" class="headerlink" title="标准正态分布"></a>标准正态分布</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f(x) = &#123;1 \over \sigma\sqrt&#123;2\pi&#125; &#125;&#123;exp&#125;^\left(&#123;-&#123;x^2 \over 2&#125;&#125;\right)</div></pre></td></tr></table></figure>
<p>$f(x) = {1 \over \sigma\sqrt{2\pi} }{\rm exp}^\left({-{x^2 \over 2}}\right)$</p>
<h3 id="希腊字母"><a href="#希腊字母" class="headerlink" title="希腊字母"></a>希腊字母</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">\alpha　A　\beta　B　\gamma　\Gamma　\delta　\Delta　\epsilon　E</div><div class="line">\varepsilon　　\zeta　Z　\eta　H　\theta　\Theta　\vartheta \iota　I</div><div class="line">\kappa　K　\lambda　\Lambda　\mu　M　\nu　N \xi　\Xi　o　O　\pi　\Pi</div><div class="line">\varpi　　\rho　P \varrho　　\sigma　\Sigma　\varsigma　　\tau　T</div><div class="line">\upsilon　\Upsilon \phi　\Phi　\varphi　　\chi　X　\psi　\Psi</div><div class="line">\omega　\Omega</div></pre></td></tr></table></figure>
<p>$\alpha　A　\beta　B　\gamma　\Gamma　\delta　\Delta　\epsilon　E$<br>$\varepsilon　　\zeta　Z　\eta　H　\theta　\Theta　\vartheta \iota　I$<br>$\kappa　K　\lambda　\Lambda　\mu　M　\nu　N \xi　\Xi　o　O　\pi　\Pi$<br>$\varpi　　\rho　P \varrho　　\sigma　\Sigma　\varsigma　　\tau　T$<br>$\upsilon　\Upsilon \phi　\Phi　\varphi　　\chi　X　\psi　\Psi$<br>$\omega　\Omega$</p>
<h3 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">\rm　　罗马体　　　　　　　\it　　意大利体</div><div class="line">\bf　　黑体　　　　　　　　\cal 　花体</div><div class="line">\sl　　倾斜体　　　　　　　\sf　　等线体</div><div class="line">\mit 　数学斜体　　　　　　\tt　　打字机字体</div><div class="line">\sc　　小体大写字母</div></pre></td></tr></table></figure>
<h3 id="其它特殊字符"><a href="#其它特殊字符" class="headerlink" title="其它特殊字符"></a>其它特殊字符</h3><h4 id="关系运算"><a href="#关系运算" class="headerlink" title="关系运算"></a>关系运算</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\pm$</td>
<td>\pm</td>
</tr>
<tr>
<td>$\times$</td>
<td>\times</td>
</tr>
<tr>
<td>$\div$</td>
<td>\div</td>
</tr>
<tr>
<td>$\mid$</td>
<td>\mid</td>
</tr>
<tr>
<td>$\nmid$</td>
<td>\nmid</td>
</tr>
<tr>
<td>$\cdot$</td>
<td>\cdot</td>
</tr>
<tr>
<td>$\circ$</td>
<td>\circ</td>
</tr>
<tr>
<td>$\ast$</td>
<td>\ast</td>
</tr>
<tr>
<td>$\bigodot$</td>
<td>\bigodot</td>
</tr>
<tr>
<td>$\bigotimes$</td>
<td>\bigotimes</td>
</tr>
<tr>
<td>$\bigoplus$</td>
<td>\bigoplus</td>
</tr>
<tr>
<td>$\leq$</td>
<td>\leq</td>
</tr>
<tr>
<td>$\geq$</td>
<td>\geq</td>
</tr>
<tr>
<td>$\neq$</td>
<td>\neq</td>
</tr>
<tr>
<td>$\approx$</td>
<td>\approx</td>
</tr>
<tr>
<td>$\equiv$</td>
<td>\equiv</td>
</tr>
<tr>
<td>$\sum$</td>
<td>\sum</td>
</tr>
<tr>
<td>$\prod$</td>
<td>\prod</td>
</tr>
<tr>
<td>$\coprod$</td>
<td>\coprod</td>
</tr>
</tbody>
</table>
<h4 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\emptyset$</td>
<td>\emptyset</td>
</tr>
<tr>
<td>$\in$</td>
<td>\in</td>
</tr>
<tr>
<td>$\notin$</td>
<td>\notin</td>
</tr>
<tr>
<td>$\subset$</td>
<td>\subset</td>
</tr>
<tr>
<td>$\supset$</td>
<td>\supset</td>
</tr>
<tr>
<td>$\subseteq$</td>
<td>\subseteq</td>
</tr>
<tr>
<td>$\supseteq$</td>
<td>\supseteq</td>
</tr>
<tr>
<td>$\bigcap$</td>
<td>\bigcap</td>
</tr>
<tr>
<td>$\bigcup$</td>
<td>\bigcup</td>
</tr>
<tr>
<td>$\bigvee$</td>
<td>\bigvee</td>
</tr>
<tr>
<td>$\bigwedge$</td>
<td>\bigwedge</td>
</tr>
<tr>
<td>$\biguplus$</td>
<td>\biguplus</td>
</tr>
<tr>
<td>$\bigsqcup$</td>
<td>\bigsqcup</td>
</tr>
</tbody>
</table>
<h4 id="对数运算"><a href="#对数运算" class="headerlink" title="对数运算"></a>对数运算</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\log$</td>
<td>\log</td>
</tr>
<tr>
<td>$\lg$</td>
<td>\lg</td>
</tr>
<tr>
<td>$\ln$</td>
<td>\ln</td>
</tr>
</tbody>
</table>
<h4 id="三角运算"><a href="#三角运算" class="headerlink" title="三角运算"></a>三角运算</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\bot$</td>
<td>\bot</td>
</tr>
<tr>
<td>$\angle$</td>
<td>\angle</td>
</tr>
<tr>
<td>$30^\circ$</td>
<td>30^\circ</td>
</tr>
<tr>
<td>$\sin$</td>
<td>\sin</td>
</tr>
<tr>
<td>$\cos$</td>
<td>\cos</td>
</tr>
<tr>
<td>$\tan$</td>
<td>\tan</td>
</tr>
<tr>
<td>$\cot$</td>
<td>\cot</td>
</tr>
<tr>
<td>$\sec$</td>
<td>\sec</td>
</tr>
<tr>
<td>$\csc$</td>
<td>\csc</td>
</tr>
</tbody>
</table>
<h4 id="微积分运算"><a href="#微积分运算" class="headerlink" title="微积分运算"></a>微积分运算</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\prime$</td>
<td>\prime</td>
</tr>
<tr>
<td>$\int$</td>
<td>\int</td>
</tr>
<tr>
<td>$\iint$</td>
<td>\iint</td>
</tr>
<tr>
<td>$\iiint$</td>
<td>\iiint</td>
</tr>
<tr>
<td>$\iiiint$</td>
<td>\iiiint</td>
</tr>
<tr>
<td>$\oint$</td>
<td>\oint</td>
</tr>
<tr>
<td>$\lim$</td>
<td>\lim</td>
</tr>
<tr>
<td>$\infty$</td>
<td>\infty</td>
</tr>
<tr>
<td>$\nabla$</td>
<td>\nabla</td>
</tr>
</tbody>
</table>
<h4 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\because$</td>
<td>\because</td>
</tr>
<tr>
<td>$\therefore$</td>
<td>\therefore</td>
</tr>
<tr>
<td>$\forall$</td>
<td>\forall</td>
</tr>
<tr>
<td>$\exists$</td>
<td>\exists</td>
</tr>
<tr>
<td>$\not=$</td>
<td>\not=</td>
</tr>
<tr>
<td>$\not&gt;$</td>
<td>\not&gt;</td>
</tr>
<tr>
<td>$\not\subset$</td>
<td>\not\subset</td>
</tr>
</tbody>
</table>
<h4 id="戴帽符号"><a href="#戴帽符号" class="headerlink" title="戴帽符号"></a>戴帽符号</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\hat{y}$</td>
<td>\hat{y}</td>
</tr>
<tr>
<td>$\check{y}$</td>
<td>\check{y}</td>
</tr>
<tr>
<td>$\breve{y}$</td>
<td>\breve{y}</td>
</tr>
</tbody>
</table>
<h4 id="连线符号"><a href="#连线符号" class="headerlink" title="连线符号"></a>连线符号</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\overline{a+b+c+d}$</td>
<td>\overline{a+b+c+d}</td>
</tr>
<tr>
<td>$\underline{a+b+c+d}$</td>
<td>\underline{a+b+c+d}</td>
</tr>
</tbody>
</table>
<h4 id="箭头符号"><a href="#箭头符号" class="headerlink" title="箭头符号"></a>箭头符号</h4><table>
<thead>
<tr>
<th>符号</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\uparrow$</td>
<td>\uparrow</td>
</tr>
<tr>
<td>$\downarrow$</td>
<td>\downarrow</td>
</tr>
<tr>
<td>$\Uparrow$</td>
<td>\Uparrow</td>
</tr>
<tr>
<td>$\Downarrow$</td>
<td>\Downarrow</td>
</tr>
<tr>
<td>$\rightarrow$</td>
<td>\rightarrow</td>
</tr>
<tr>
<td>$\leftarrow$</td>
<td>\leftarrow</td>
</tr>
<tr>
<td>$\Rightarrow$</td>
<td>\Rightarrow</td>
</tr>
<tr>
<td>$\Leftarrow$</td>
<td>\Leftarrow</td>
</tr>
<tr>
<td>$\longrightarrow$</td>
<td>\longrightarrow</td>
</tr>
<tr>
<td>$\longleftarrow$</td>
<td>\longleftarrow</td>
</tr>
<tr>
<td>$\Longrightarrow$</td>
<td>\Longrightarrow</td>
</tr>
<tr>
<td>$\Longleftarrow$</td>
<td>\Longleftarrow</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/mark/mark/markdown-mathjax.html" data-id="cjum4nxuu000naoocpwor7xfl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>

<!--

-->

<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-mark/markdown-mathjax" data-title="Mathjax in Markdown" data-url="undefined"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"yangdage"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

<!-- 搜索引擎优化 start-->

<!-- 搜索引擎优化 end-->
  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="page-number" href="/blog/page/3/">3</a><a class="extend next" rel="next" href="/blog/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/cache/">cache</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/go/">go</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/mark/">mark</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/03/">三月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/08/">八月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/05/">五月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/04/">四月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/03/">三月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/02/">二月 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/mark/mark/rest-api-design.html">REST API设计最佳实践</a>
          </li>
        
          <li>
            <a href="/blog/mark/go/golang问题记录.html">golang问题记录</a>
          </li>
        
          <li>
            <a href="/blog/mark/mark/use-make-in-windows.html">Windows下使用make命令</a>
          </li>
        
          <li>
            <a href="/blog/go/go/golang闭包问题.html">golang闭包问题</a>
          </li>
        
          <li>
            <a href="/blog/go/go/golang时区转换问题.html">golang时区转换问题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 yangdage<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="http://apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script> <script type="text/javascript">
//<![CDATA[
if (typeof jQuery == 'undefined') {
document.write(unescape("%3Cscript src='/js/jquery-2.0.3.min.js' type='text/javascript'%3E%3C/script%3E"));
}
// ]]>
</script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>